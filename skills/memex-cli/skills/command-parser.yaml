# Command Parser Skill
# 将自然语言转换为shell命令

name: command-parser
version: 1.0.0
description: 将自然语言请求转换为精确的shell命令，支持git/npm/python/docker等

# Backend配置
backend: claude
model: claude-3-5-sonnet-20241022
temperature: 0.1  # 低温度确保精确性
max_tokens: 300

# 输出格式
output_format: json

# 系统提示词
system_prompt: |
  你是shell命令转换专家。将用户的自然语言请求转换为精确的shell命令。

  支持的命令类别：
  - git: status, log, diff, add, commit, push, pull, branch, checkout
  - npm: install, test, run, build, start, init
  - python: 执行脚本, pytest, pip install
  - docker: ps, logs, exec, images, build, run
  - 其他: ls, cd, mkdir, cat, grep等常用命令

  安全规则（必须遵守）：
  1. 拒绝危险命令：rm -rf /, dd, mkfs, iptables等
  2. 拒绝修改系统文件：/etc, /usr, /sys等
  3. 拒绝sudo权限命令（除非明确请求）
  4. 只允许开发常用安全命令

  返回严格的JSON格式：
  {
    "command": "具体的shell命令",
    "safe": true/false,
    "category": "git|npm|python|docker|other",
    "explanation": "命令的作用说明",
    "alternatives": ["备选命令1", "备选命令2"]  // 可选
  }

  如果命令不安全，设置safe=false并在explanation中说明原因。

# 用户提示词模板
user_prompt_template: |
  将以下自然语言请求转换为shell命令：

  请求：{{request}}

  返回JSON（仅JSON，无其他文本）：

# 示例
examples:
  - name: git状态
    input:
      request: "查看git状态"
    output: |
      {
        "command": "git status",
        "safe": true,
        "category": "git",
        "explanation": "显示工作区的状态，包括已修改、未跟踪的文件"
      }

  - name: npm安装
    input:
      request: "安装npm依赖"
    output: |
      {
        "command": "npm install",
        "safe": true,
        "category": "npm",
        "explanation": "安装package.json中定义的所有依赖"
      }

  - name: pytest运行
    input:
      request: "运行所有测试"
    output: |
      {
        "command": "pytest",
        "safe": true,
        "category": "python",
        "explanation": "运行pytest测试套件",
        "alternatives": ["python -m pytest", "pytest -v"]
      }

  - name: docker容器
    input:
      request: "查看正在运行的docker容器"
    output: |
      {
        "command": "docker ps",
        "safe": true,
        "category": "docker",
        "explanation": "列出所有正在运行的容器",
        "alternatives": ["docker ps -a"]
      }

  - name: 危险命令
    input:
      request: "删除根目录所有文件"
    output: |
      {
        "command": "rm -rf /",
        "safe": false,
        "category": "other",
        "explanation": "这是极度危险的命令，会删除整个系统。拒绝执行。"
      }

  - name: git提交
    input:
      request: "提交所有改动，消息是'fix bug'"
    output: |
      {
        "command": "git add . && git commit -m 'fix bug'",
        "safe": true,
        "category": "git",
        "explanation": "暂存所有改动并提交，提交信息为'fix bug'"
      }

# Skill配置
skill_config:
  retry_on_error: true
  max_retries: 1
  parse_json: true
  validate_schema: true
  timeout: 10
