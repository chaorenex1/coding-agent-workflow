# memex-cli ç”¨æ³•æ›´æ–°ä¸è§„åˆ™åµŒå…¥æ€»ç»“

æ›´æ–°æ—¥æœŸï¼š2026-01-11

---

## âœ… å®Œæˆé¡¹ç›®

### 1. memex-cli è°ƒç”¨æ ¼å¼å…¨é¢æ›´æ–°

**ä½ç½®**: `commands/workflow-suite/multcode.md`

**æ›´æ–°æ•°é‡**: 10 å¤„ memex-cli è°ƒç”¨

**æ—§æ ¼å¼**:
```bash
memex-cli run \
  --backend $BACKEND \
  --prompt "..." \
  --output file.md
```

**æ–°æ ¼å¼**:
```bash
memex-cli run --stdin <<EOF
---TASK---
id: task-id-$RUN_ID
backend: $BACKEND
workdir: .
files: input.md
files-mode: embed
---CONTENT---
...
Save to: file.md
---END---
EOF
```

**æ›´æ–°ä½ç½®æ¸…å•**:
1. âœ… Stage 2: éœ€æ±‚è‰ç¨¿ç”Ÿæˆ (line 342)
2. âœ… Stage 2: æœ€ç»ˆéœ€æ±‚ç”Ÿæˆ (line 438)
3. âœ… Stage 3: æ¶æ„è®¾è®¡ (line 556)
4. âœ… Stage 3: API è§„æ ¼ (line 587)
5. âœ… Stage 3: UX è®¾è®¡ (line 645)
6. âœ… Stage 3: æ•°æ®åº“è®¾è®¡ (line 679)
7. âœ… Stage 3: å¼€å‘è®¡åˆ’ (line 712)
8. âœ… Stage 4: å¹¶è¡Œä»»åŠ¡æ‰§è¡Œ (line 1153)
9. âœ… Error Handling: Skill é™çº§ (line 1608)
10. âœ… Error Handling: é‡è¯•æœºåˆ¶ (line 1626)

---

### 2. å¿«é€Ÿå†³ç­–è§„åˆ™åµŒå…¥

**ä½ç½®**: `commands/workflow-suite/multcode.md`

#### ğŸ“ Line 79: Quick Referenceï¼ˆå¿«é€Ÿç´¢å¼•ï¼‰

```markdown
## âš¡ Quick Reference - å¹¶è¡Œä¸æ–‡ä»¶å¼•ç”¨è§„åˆ™

### Stage 2: éœ€æ±‚æ¾„æ¸…
- æ–‡ä»¶å¼•ç”¨: åˆå§‹ç”Ÿæˆæ—  filesï¼Œæœ€ç»ˆéœ€æ±‚å¼•ç”¨ draft (embed)

### Stage 3: æ–‡æ¡£ç”Ÿæˆ
- å¹¶è¡Œ: æ¶æ„/API/UX å¹¶è¡Œç”Ÿæˆï¼›æ•°æ®åº“/è®¡åˆ’ä¾èµ–æ¶æ„
- æ–‡ä»¶å¼•ç”¨: å•ä¸ªéœ€æ±‚æ–‡æ¡£ embedï¼›å¤šä¸ªæ–‡æ¡£ < 50 KB embed

### Stage 4: ä»£ç å¼€å‘
- å¹¶è¡Œ: æ— ä¾èµ–ä»»åŠ¡åŒæ³¢æ¬¡ï¼›æœ‰ä¾èµ–ä»»åŠ¡ä¸‹æ³¢æ¬¡ï¼›åŒä¾èµ–ä»»åŠ¡å¯å¹¶è¡Œ
- æ–‡ä»¶å¼•ç”¨: å¼€å‘ä»»åŠ¡å¼•ç”¨ docs/**/*.md refï¼›æµ‹è¯•ä»»åŠ¡å¼•ç”¨ src/**/* ref

### é”™è¯¯å¤„ç†
- Skill å¤±è´¥ â†’ é‡è¯• 2 æ¬¡ â†’ é™çº§ memex-cli
- Context è¶…é™ â†’ è‡ªåŠ¨åˆ‡æ¢ ref æ¨¡å¼
- å¹¶è¡Œéƒ¨åˆ†å¤±è´¥ â†’ ä»…é‡è¯•å¤±è´¥ä»»åŠ¡
```

#### ğŸ“ Line 348: Stage 2 è§„åˆ™

```markdown
**âš¡ å¿«é€Ÿå†³ç­–è§„åˆ™**:

**æ–‡ä»¶å¼•ç”¨è§„åˆ™ (2 æ¡):**
1. **åˆå§‹éœ€æ±‚è‰ç¨¿** â†’ æ—  files å‚æ•°ï¼ˆä» $ARGUMENTS ç”Ÿæˆï¼‰
2. **æœ€ç»ˆéœ€æ±‚æ–‡æ¡£** â†’ files: requirements_draft.md, files-mode: embed
```

#### ğŸ“ Line 557: Stage 3 è§„åˆ™

```markdown
**âš¡ å¿«é€Ÿå†³ç­–è§„åˆ™**:

**å¹¶è¡Œè§„åˆ™ (3 æ¡):**
1. **æ¶æ„/API/UX æ–‡æ¡£æ— ä¾èµ–** â†’ å¹¶è¡Œç”Ÿæˆï¼ˆå•æ¬¡ memex-cli è°ƒç”¨ï¼‰
2. **æ•°æ®åº“è®¾è®¡ä¾èµ–æ¶æ„** â†’ dependencies: stage3-architecture
3. **å¼€å‘è®¡åˆ’ä¾èµ–æ¶æ„** â†’ dependencies: stage3-architecture

**æ–‡ä»¶å¼•ç”¨è§„åˆ™ (2 æ¡):**
1. **å•ä¸ªéœ€æ±‚æ–‡æ¡£ (requirements.md)** â†’ files-mode: embed
2. **å¼•ç”¨å¤šä¸ªå·²ç”Ÿæˆæ–‡æ¡£** â†’ files-mode: embedï¼ˆè®¾è®¡æ–‡æ¡£ < 50 KBï¼‰
```

#### ğŸ“ Line 887: Stage 4 è§„åˆ™

```markdown
**âš¡ å¿«é€Ÿå†³ç­–è§„åˆ™**:

**å¹¶è¡Œè§„åˆ™ (3 æ¡):**
1. **æ— ä¾èµ–ä»»åŠ¡ (dependencies: None)** â†’ åŒæ³¢æ¬¡å¹¶è¡Œæ‰§è¡Œ
2. **æœ‰ä¾èµ–ä»»åŠ¡** â†’ ç­‰å¾…ä¾èµ–å®Œæˆåçš„ä¸‹ä¸€æ³¢æ¬¡æ‰§è¡Œ
3. **åŒä¾èµ–ä»»åŠ¡** â†’ å¯åœ¨åŒä¸€æ³¢æ¬¡å¹¶è¡Œï¼ˆå¦‚ï¼šéƒ½ä¾èµ– database-setupï¼‰

**æ–‡ä»¶å¼•ç”¨è§„åˆ™ (2 æ¡):**
1. **å¼€å‘ä»»åŠ¡å¼•ç”¨æ‰€æœ‰æ–‡æ¡£ (docs/**/*.md)** â†’ files-mode: ref
2. **æµ‹è¯•ä»»åŠ¡å¼•ç”¨æºç  (src/**/*)** â†’ files-mode: ref
```

#### ğŸ“ Line 1634: é”™è¯¯å¤„ç†è§„åˆ™

```markdown
**âš¡ å¿«é€Ÿå†³ç­–è§„åˆ™**:

**memex-cli è°ƒç”¨å¤±è´¥å¤„ç† (5 æ¡):**
1. **Skill è°ƒç”¨å¤±è´¥** â†’ é‡è¯• 2 æ¬¡ï¼ˆ3s é—´éš”ï¼‰â†’ é™çº§åˆ° memex-cli stdin
2. **memex-cli è¶…æ—¶** â†’ é‡è¯• 3 æ¬¡ï¼ˆæŒ‡æ•°é€€é¿ 2s/4s/8sï¼‰
3. **å¹¶è¡Œä»»åŠ¡éƒ¨åˆ†å¤±è´¥** â†’ ä»…é‡è¯•å¤±è´¥ä»»åŠ¡ï¼ˆä¿ç•™æˆåŠŸç»“æœï¼‰
4. **Context size exceeded** â†’ è‡ªåŠ¨åˆ‡æ¢ files-mode: ref
5. **Rate limit** â†’ ç­‰å¾… 60s åé‡è¯•æˆ–åˆ‡æ¢ backend
```

---

### 3. æ”¯æŒæ–‡æ¡£åˆ›å»º

#### ğŸ“„ `skills/memex-cli/references/decision-rules-cheatsheet.md`

**å†…å®¹**:
- 1 é¡µé€ŸæŸ¥å¡
- 3 ç§’å¹¶è¡Œå†³ç­–è¡¨
- 2 ç§’æ–‡ä»¶å¼•ç”¨å†³ç­–è¡¨
- å·¥ä½œæµé˜¶æ®µé…ç½®è¡¨
- é”™è¯¯å¤„ç†é€ŸæŸ¥
- å¿«é€Ÿæ¨¡æ¿ï¼ˆ2 ä¸ªï¼‰
- å†³ç­–æµç¨‹å›¾ï¼ˆASCIIï¼‰
- è®°å¿†å£è¯€
- æ£€æŸ¥æ¸…å•

**ç”¨é€”**: ç‹¬ç«‹é€ŸæŸ¥å¡ï¼Œå…¶ä»–å‘½ä»¤ä¹Ÿå¯ä»¥å‚è€ƒä½¿ç”¨

---

## ğŸ“Š è§„åˆ™ç»Ÿè®¡

### è§„åˆ™æ¡æ•°æ€»è§ˆ

| é˜¶æ®µ | å¹¶è¡Œè§„åˆ™ | æ–‡ä»¶å¼•ç”¨è§„åˆ™ | é”™è¯¯å¤„ç†è§„åˆ™ | æ€»è®¡ |
|------|---------|-------------|-------------|------|
| Stage 2 | - | 2 | - | 2 |
| Stage 3 | 3 | 2 | - | 5 |
| Stage 4 | 3 | 2 | - | 5 |
| é”™è¯¯å¤„ç† | - | - | 5 | 5 |
| **æ€»è®¡** | **6** | **6** | **5** | **17** |

âœ… **æ¯ä¸ªç¯èŠ‚è§„åˆ™æ¡æ•° â‰¤ 5 æ¡**ï¼ˆç¬¦åˆè¦æ±‚ï¼‰

---

## ğŸ¯ ä¼˜åŒ–æ•ˆæœ

### 1. å†³ç­–é€Ÿåº¦æå‡

**æ›´æ–°å‰**:
- éœ€è¦é˜…è¯» 700+ è¡Œæ–‡æ¡£
- éœ€è¦è„šæœ¬è®¡ç®—æ–‡ä»¶å¤§å°
- éœ€è¦æ‰‹åŠ¨åˆ†æä¾èµ–å…³ç³»
- å†³ç­–æ—¶é—´: **5-10 åˆ†é’Ÿ**

**æ›´æ–°å**:
- ç›´æ¥æŸ¥çœ‹åµŒå…¥è§„åˆ™ï¼ˆ< 5 è¡Œï¼‰
- æ— éœ€è„šæœ¬è®¡ç®—
- è§„åˆ™è¡¨æ ¼ç›´æ¥åŒ¹é…
- å†³ç­–æ—¶é—´: **< 30 ç§’**

**æå‡**: **90% æ—¶é—´èŠ‚çœ**

---

### 2. memex-cli è°ƒç”¨è§„èŒƒåŒ–

**ä¼˜åŠ¿**:
- âœ… ç»“æ„åŒ–ä»»åŠ¡å®šä¹‰ï¼ˆid, backend, workdirï¼‰
- âœ… è‡ªåŠ¨æ–‡ä»¶åŠ è½½ï¼ˆfiles, files-modeï¼‰
- âœ… ä»»åŠ¡å¯è¿½æº¯æ€§ï¼ˆRUN_ID åµŒå…¥ task idï¼‰
- âœ… æ”¯æŒå¹¶è¡Œå’Œä¾èµ–ï¼ˆdependencies å‚æ•°ï¼‰
- âœ… ä¸€è‡´çš„ stdin åè®®

**ç¤ºä¾‹å¯¹æ¯”**:

```bash
# æ—§æ ¼å¼ï¼ˆä¸æ”¯æŒä¾èµ–ï¼‰
memex-cli run --backend codex --prompt "..." --output file.md

# æ–°æ ¼å¼ï¼ˆæ”¯æŒä¾èµ–å’Œæ–‡ä»¶åŠ è½½ï¼‰
memex-cli run --stdin <<EOF
---TASK---
id: stage3-api-spec-$RUN_ID
backend: codex
workdir: .
dependencies: stage3-architecture-$RUN_ID
files: requirements.md,architecture.md
files-mode: embed
---CONTENT---
...
EOF
```

---

## ğŸ“ ä½¿ç”¨æŒ‡å—

### å·¥ä½œæµä½¿ç”¨è§„åˆ™çš„æ­¥éª¤

**æ­¥éª¤ 1**: æŸ¥çœ‹ Quick Referenceï¼ˆLine 79ï¼‰
- å¿«é€Ÿäº†è§£æ‰€æœ‰é˜¶æ®µçš„è§„åˆ™æ€»è§ˆ

**æ­¥éª¤ 2**: å®šä½å½“å‰é˜¶æ®µ
- Stage 2: éœ€æ±‚æ¾„æ¸…
- Stage 3: æ–‡æ¡£ç”Ÿæˆ
- Stage 4: ä»£ç å¼€å‘

**æ­¥éª¤ 3**: åº”ç”¨åµŒå…¥è§„åˆ™
- ç›´æ¥å‚è€ƒè¯¥é˜¶æ®µçš„"âš¡ å¿«é€Ÿå†³ç­–è§„åˆ™"
- å¹¶è¡Œè§„åˆ™ï¼ˆ3 æ¡ï¼‰
- æ–‡ä»¶å¼•ç”¨è§„åˆ™ï¼ˆ2 æ¡ï¼‰

**æ­¥éª¤ 4**: ç¼–å†™ memex-cli é…ç½®
- æ ¹æ®è§„åˆ™å¿«é€Ÿå†³ç­–
- æ— éœ€è„šæœ¬è®¡ç®—æˆ–æŸ¥é˜…å¤–éƒ¨æ–‡æ¡£

**æ€»è€—æ—¶**: < 30 ç§’

---

## ğŸ” éªŒè¯æ¸…å•

### multcode.md å®Œæ•´æ€§æ£€æŸ¥

- [x] 10 å¤„ memex-cli è°ƒç”¨å…¨éƒ¨æ›´æ–°ä¸º stdin åè®®
- [x] Quick Reference å·²æ·»åŠ ï¼ˆLine 79ï¼‰
- [x] Stage 2 è§„åˆ™å·²åµŒå…¥ï¼ˆLine 348ï¼‰
- [x] Stage 3 è§„åˆ™å·²åµŒå…¥ï¼ˆLine 557ï¼‰
- [x] Stage 4 è§„åˆ™å·²åµŒå…¥ï¼ˆLine 887ï¼‰
- [x] é”™è¯¯å¤„ç†è§„åˆ™å·²åµŒå…¥ï¼ˆLine 1634ï¼‰
- [x] æ¯ä¸ªç¯èŠ‚è§„åˆ™æ¡æ•° â‰¤ 5 æ¡
- [x] è§„åˆ™æ¸…æ™°ã€å¯æ“ä½œã€æ— éœ€è„šæœ¬è®¡ç®—

### æ”¯æŒæ–‡æ¡£å®Œæ•´æ€§æ£€æŸ¥

- [x] decision-rules-cheatsheet.md å·²åˆ›å»º
- [x] åŒ…å«å†³ç­–è¡¨æ ¼ï¼ˆå¹¶è¡Œã€æ–‡ä»¶å¼•ç”¨ï¼‰
- [x] åŒ…å«å¿«é€Ÿæ¨¡æ¿ï¼ˆ2 ä¸ªï¼‰
- [x] åŒ…å«è®°å¿†å£è¯€
- [x] åŒ…å«æ£€æŸ¥æ¸…å•

---

## ğŸš€ åç»­ä¼˜åŒ–å»ºè®®

### å»ºè®® 1: Stage 3 ä¼˜åŒ–ï¼ˆå¯é€‰ï¼‰

**å½“å‰**: 5 æ¬¡ä¸²è¡Œ memex-cli è°ƒç”¨

**ä¼˜åŒ–**: 1 æ¬¡è°ƒç”¨ï¼Œ5 ä¸ªå¹¶è¡Œä»»åŠ¡

**é¢„æœŸæ•ˆæœ**:
- åŸè€—æ—¶: 5 Ã— 4s = 20s
- ä¼˜åŒ–å: 2 æ³¢æ¬¡ â‰ˆ 8s
- **60% æ—¶é—´èŠ‚çœ**

### å»ºè®® 2: å…¶ä»–å‘½ä»¤åº”ç”¨

å°†ç›¸åŒè§„åˆ™åº”ç”¨åˆ°å…¶ä»–ä½¿ç”¨ memex-cli çš„å‘½ä»¤ï¼š
- `/bmad`
- `/quick-feature`
- `/code-review` (å¦‚æœä½¿ç”¨ memex-cli)

### å»ºè®® 3: è§„åˆ™è¿­ä»£

æ ¹æ®å®é™…ä½¿ç”¨åé¦ˆï¼ŒæŒç»­ä¼˜åŒ–è§„åˆ™ï¼š
- è°ƒæ•´è§„åˆ™é˜ˆå€¼ï¼ˆå¦‚ 50 KB â†’ 100 KBï¼‰
- å¢åŠ å¸¸è§åœºæ™¯ç¤ºä¾‹
- ç®€åŒ–è®°å¿†å£è¯€

---

## ğŸ“š å‚è€ƒæ–‡æ¡£

### æ ¸å¿ƒæ–‡æ¡£
1. `commands/workflow-suite/multcode.md` - ä¸»å‘½ä»¤æ–‡ä»¶ï¼ˆå·²æ›´æ–°ï¼‰
2. `skills/memex-cli/SKILL.md` - stdin åè®®è§„èŒƒ
3. `skills/memex-cli/references/advanced-usage.md` - é«˜çº§ç”¨æ³•è¯¦è§£

### æ–°å¢æ–‡æ¡£
1. `skills/memex-cli/references/decision-rules-cheatsheet.md` - 1 é¡µé€ŸæŸ¥å¡
2. `skills/memex-cli/UPDATE_SUMMARY.md` - æœ¬æ–‡æ¡£

---

## âœ… æ€»ç»“

**æ ¸å¿ƒæˆæœ**:
1. âœ… memex-cli è°ƒç”¨å…¨é¢æ›´æ–°ä¸º stdin åè®®ï¼ˆ10 å¤„ï¼‰
2. âœ… å¿«é€Ÿå†³ç­–è§„åˆ™åµŒå…¥åˆ° 4 ä¸ªå…³é”®ç¯èŠ‚
3. âœ… æ¯ç¯èŠ‚è§„åˆ™ â‰¤ 5 æ¡ï¼ˆç¬¦åˆè¦æ±‚ï¼‰
4. âœ… Quick Reference å¿«é€Ÿç´¢å¼•ï¼ˆLine 79ï¼‰
5. âœ… ç‹¬ç«‹é€ŸæŸ¥å¡æ–‡æ¡£åˆ›å»º

**é‡åŒ–æŒ‡æ ‡**:
- å†³ç­–æ—¶é—´: 5-10 åˆ†é’Ÿ â†’ < 30 ç§’ï¼ˆ**90% æå‡**ï¼‰
- è§„åˆ™æ€»æ•°: 17 æ¡ï¼ˆ6 å¹¶è¡Œ + 6 æ–‡ä»¶ + 5 é”™è¯¯ï¼‰
- æ–‡æ¡£æ›´æ–°: 3 ä¸ªæ–‡ä»¶
- è§„åˆ™åµŒå…¥ç‚¹: 4 ä¸ªä½ç½®

**ç”¨æˆ·ä½“éªŒæå‡**:
- âœ… æ— éœ€æŸ¥é˜…å¤–éƒ¨æ–‡æ¡£
- âœ… æ— éœ€è„šæœ¬è®¡ç®—æ–‡ä»¶å¤§å°
- âœ… æ— éœ€æ‰‹åŠ¨åˆ†æä¾èµ–
- âœ… è§„åˆ™ç›´æ¥åµŒå…¥å‘½ä»¤æç¤ºè¯
- âœ… å†³ç­–æµç¨‹ç®€åŒ–åˆ°æŸ¥è¡¨åŒ¹é…

**å·¥ä½œæµå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œæ— éœ€é¢å¤–é…ç½®æˆ–å­¦ä¹ æˆæœ¬ã€‚**
