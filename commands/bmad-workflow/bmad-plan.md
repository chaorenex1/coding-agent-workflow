---
description: BMAD Phase 2 - Create Product Requirements Document (PRD) and detailed user stories from project brief
argument-hint: [feature-focus]
allowed-tools: Read, Write, Edit, Grep, Glob, Task
model: claude-opus-4-5-20251022
---

# BMAD Phase 2: Planning

You are initiating **Phase 2 of the BMAD workflow** - the Planning phase. Your role is to transform the Project Brief into a comprehensive Product Requirements Document (PRD) and detailed user stories.

## Context

**Feature Focus** (optional): $ARGUMENTS

**Previous Phase Artifacts**:
@docs/bmad/01-analysis/project-brief.md
@docs/bmad/01-analysis/market-analysis.md

**Current Project State**:
- Existing docs: !`find docs/bmad -name "*.md" -type f 2>/dev/null`

## Your Mission

As the **Product Owner Agent**, create comprehensive product documentation that will guide development.

### Step 1: Requirements Analysis

Analyze the project brief and extract:

1. **Core Features**
   - Must-have features for MVP
   - Nice-to-have features for future
   - Out-of-scope features

2. **User Journeys**
   - Primary user flows
   - Secondary user flows
   - Edge cases

3. **Success Metrics**
   - Key Performance Indicators (KPIs)
   - Measurable success criteria
   - Validation checkpoints

### Step 2: Create PRD

Generate detailed Product Requirements Document:

#### Artifact: docs/bmad/prd.md

```markdown
# Product Requirements Document (PRD)

## Document Info
- **Product**: [Product Name]
- **Version**: 1.0.0
- **Date**: [Current Date]
- **Author**: BMAD Product Owner Agent

---

## 1. Overview

### 1.1 Purpose
[Why this product exists]

### 1.2 Scope
[What's included and excluded in MVP]

### 1.3 Target Users
[Reference to personas from market analysis]

---

## 2. Goals & Success Metrics

### 2.1 Business Goals
- [Goal 1 with measurable target]
- [Goal 2 with measurable target]

### 2.2 User Goals
- [Goal 1 from user perspective]
- [Goal 2 from user perspective]

### 2.3 Key Performance Indicators (KPIs)
| KPI | Target | Measurement Method |
|-----|--------|-------------------|
| [Metric] | [Target] | [How to measure] |

---

## 3. Features & Requirements

### 3.1 MVP Features (P0)

#### Feature 1: [Name]
- **Description**: [What it does]
- **User Story**: As a [user], I want [action] so that [benefit]
- **Acceptance Criteria**:
  - [ ] [Criterion 1]
  - [ ] [Criterion 2]
- **Priority**: P0 (Must Have)

#### Feature 2: [Name]
[Same structure]

### 3.2 Post-MVP Features (P1)
[Features for future iterations]

### 3.3 Out of Scope
[Explicitly excluded features]

---

## 4. User Flows

### 4.1 Primary Flow: [Name]
```
User Action → System Response → Next Step
    ↓
[Flow diagram in text]
```

### 4.2 Secondary Flows
[Other important flows]

---

## 5. Technical Constraints

### 5.1 Performance Requirements
- Page load time: < [X]s
- API response time: < [X]ms
- Concurrent users: [X]

### 5.2 Platform Requirements
- Browser support: [List]
- Mobile responsive: [Yes/No]
- Accessibility: WCAG [Level]

### 5.3 Integration Requirements
- [Required integrations]

---

## 6. Security & Compliance

### 6.1 Authentication
- [Auth requirements]

### 6.2 Data Privacy
- [Privacy requirements, GDPR if applicable]

### 6.3 Security Standards
- [Security requirements]

---

## 7. Release Criteria

### 7.1 MVP Launch Checklist
- [ ] All P0 features implemented
- [ ] Unit test coverage > [X]%
- [ ] E2E tests passing
- [ ] Performance benchmarks met
- [ ] Security audit passed
- [ ] Documentation complete

---

Generated by BMAD Workflow - Phase 2: Planning
```

### Step 3: Create User Stories

Generate detailed user stories with epic structure:

#### Artifact: docs/bmad/user-stories.md

```markdown
# User Stories

## Epic Overview

| Epic ID | Name | Priority | Stories |
|---------|------|----------|---------|
| EPIC-001 | [Name] | P0 | [Count] |
| EPIC-002 | [Name] | P0 | [Count] |
| EPIC-003 | [Name] | P1 | [Count] |

---

## EPIC-001: [Epic Name]

### Epic Description
[What this epic delivers]

### Stories

#### STORY-001: [Story Title]

**As a** [user type]
**I want** [action/capability]
**So that** [benefit/value]

**Acceptance Criteria:**
- [ ] Given [context], when [action], then [expected result]
- [ ] Given [context], when [action], then [expected result]
- [ ] [Additional criteria]

**Technical Notes:**
- [Implementation hints]
- [Dependencies]

**Estimation:** [S/M/L or Story Points]
**Priority:** P0

---

#### STORY-002: [Story Title]
[Same structure]

---

## EPIC-002: [Epic Name]
[Same structure]

---

## Story Dependencies Graph

```
STORY-001 ──→ STORY-002
    │
    └──→ STORY-003 ──→ STORY-004
                         │
STORY-005 ───────────────┘
```

---

## Sprint Planning Recommendations

### Sprint 1 (MVP Core)
- STORY-001: [Name]
- STORY-002: [Name]

### Sprint 2 (MVP Extended)
- STORY-003: [Name]
- STORY-004: [Name]

---

Generated by BMAD Workflow - Phase 2: Planning
```

## Output Requirements

### 文件沉淀位置

```
docs/bmad/02-planning/
├── prd.md              # 产品需求文档
└── user-stories.md     # 用户故事
```

### 操作步骤

1. **读取Phase 1产出**
   - `docs/bmad/01-analysis/project-brief.md`
   - `docs/bmad/01-analysis/market-analysis.md`

2. **创建目录结构**
   ```bash
   mkdir -p docs/bmad/02-planning
   ```

3. **写入文档**
   - `docs/bmad/02-planning/prd.md`
   - `docs/bmad/02-planning/user-stories.md`

4. **更新状态** (如果 .bmad/ 存在)
   ```yaml
   # .bmad/state.yaml
   workflow:
     current_phase: 2
     phase_status:
       1: completed
       2: completed
   ```

5. **提交到git**
   ```bash
   git add docs/bmad/02-planning/
   git commit -m "feat(bmad): Phase 2 - PRD and user stories complete"
   ```

## Success Criteria

- [ ] PRD covers all sections with specific requirements
- [ ] User stories follow proper format (As a... I want... So that...)
- [ ] Acceptance criteria are testable and specific
- [ ] Stories are prioritized (P0, P1, P2)
- [ ] Dependencies between stories are mapped
- [ ] Both artifacts written to docs/bmad/
- [ ] Files committed to git

## Next Phase

After completing this phase, run:
```
/bmad-architect
```

This will initiate Phase 3: Architecture to design the technical solution.

---

**IMPORTANT**: Reference the project-brief.md and market-analysis.md when creating requirements. Ensure all features trace back to identified user pain points and business goals.
